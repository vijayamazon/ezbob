(function(){var n,i={}.hasOwnProperty,t=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this,n.EzBob=n.EzBob||{},EzBob.AmazonStoreInfoView=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.initialize=function(){return EzBob.CT.bindShopToCT(this,"amazon")},i.prototype.render=function(){return this.$el.html($("#amazon-store-info").html()),this.form=this.$el.find(".AmazonForm"),this.validator=EzBob.validateAmazonForm(this.form),this.marketplaceId=this.$el.find("#amazonMarketplaceId"),this.merchantId=this.$el.find("#amazonMerchantId"),this.marketplaceId.withoutSpaces(),this.merchantId.withoutSpaces(),this},i.prototype.events={"click a.go-to-amazon":"enableControls","click a.connect-amazon":"connect","click a.back":"back","click .amazonscreenshot":"runTutorial","click a.print":"print","change input":"inputChanged","focusout input":"inputChanged","keyup input":"inputChanged"},i.prototype.enableControls=function(){if(this.$el.find("#amazonMarketplaceId, #amazonMerchantId").removeAttr("disabled"),this.marketplaceId.val().length===0){this.$el.find("#amazonMarketplaceIdImage").field_status("clear","right away");return}this.merchantId.val().length===0&&this.$el.find("#amazonMerchantIdImage").field_status("clear","right away")},i.prototype.inputChanged=function(){var n;return n=EzBob.Validation.checkForm(this.validator),this.$el.find("a.connect-amazon").toggleClass("disabled",!n)},i.prototype.runTutorial=function(){var t,n;return n=$("<div/>"),t=$("#amazon-gallery-container"),n.html(t.html()),n.find(".amazon-tutorial-slider").attr("id","amazon-tutorial-slider"+(new Date).getTime()).show(),n.dialog({width:"960",height:"573",modal:!0,draggable:!1,resizable:!1,close:function(){return n.empty()},dialogClass:"amazon-tutor-dlg",title:"Link Your Amazon Shop to EZBOB"}),n.find(".amazon-tutorial-slider").coinslider({width:930,height:471,delay:1e6,effect:"rain",sDelay:30,titleSpeed:50,links:!1}),!1},i.prototype.back=function(){return this.trigger("back"),!1},i.prototype.connect=function(){var t,i,n=this;return EzBob.Validation.checkForm(this.validator)?this.$el.find("a.connect-amazon").hasClass("disabled")?!1:(t=this.$el.find("#amazonMarketplaceId"),i=this.$el.find("#amazonMerchantId"),this.blockBtn(!0),$.post(window.gRootPath+"Customer/AmazonMarketplaces/ConnectAmazon",{marketplaceId:t.val(),merchantId:i.val()}).success(function(r){if(n.blockBtn(!1),r.error){EzBob.App.trigger("error",r.error),n.trigger("back");return}return EzBob.App.trigger("info",r.msg),n.trigger("completed"),n.trigger("back"),t.val(""),i.val("")}).error(function(){return EzBob.App.trigger("error","Amazon Account Adding Failed")}),!1):(this.validator.form(),!1)},i.prototype.print=function(){return window.print(),!1},i.prototype.blockBtn=function(n){return BlockUi(n?"on":"off"),this.$el.find("connect-amazon").toggleClass("disabled",n)},i.prototype.getDocumentTitle=function(){return EzBob.App.trigger("clear"),"Link Amazon Account"},i}(Backbone.View),EzBob.AmazonStoreModel=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.defaults={marketplaceId:null},i}(Backbone.Model),EzBob.AmazonStoreModels=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.model=EzBob.AmazonStoreModel,i.prototype.url=""+window.gRootPath+"Customer/AmazonMarketPlaces",i}(Backbone.Collection)}).call(this)