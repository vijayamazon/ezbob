(function(){var n,t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this;n.EzBob=n.EzBob||{};EzBob.StoreButtonView=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,n),t.prototype.template="#store-button-template",t.prototype.initialize=function(n){return this.name=n.name,this.mpAccounts=n.mpAccounts.get("customer").get("mpAccounts"),this.shops=this.mpAccounts?this.shops=_.where(this.mpAccounts,{MpName:this.name}):[],this.shopClass=n.name.replace(" ","")},t.prototype.serializeData=function(){return{name:this.name,shopClass:this.shopClass}},t.prototype.onRender=function(){var n,i,r,t;n=this.$el.find(".marketplace-button-account-"+this.shopClass);this.$el.removeClass("marketplace-button-full marketplace-button-empty");t=(this.shops.length?"Some":"No")+" accounts linked. Click to link ";this.shops.length?(this.$el.addClass("marketplace-button-full"),t+="more."):(this.$el.addClass("marketplace-button-empty"),t+="one.");this.$el.attr("title",t);switch(this.shopClass){case"eBay":case"paypal":case"FreeAgent":case"Sage":i=_.template($("#store-button-help-window-template").html());this.$el.append(i(this.serializeData()));r=JSON.parse($("#store-button-help-window-links").html());this.$el.find(".help-window-continue-link").attr("href",r[this.shopClass]);n.attr("href","#"+this.shopClass+"_help");n.colorbox({inline:!0,transition:"elastic",onClosed:function(){var n;return n=$("#link_account_implicit_back"),n.length?EzBob.UiAction.saveOne("click",n):void 0}});break;default:n.click(function(n){return function(){return EzBob.App.trigger("ct:storebase.shops.connect",n)}}(this.shopClass))}return n.hoverIntent(function(){return $(".onhover",this).animate({top:0,opacity:1})},function(){return $(".onhover",this).animate({top:"60px",opacity:0})})},t.prototype.isAddingAllowed=function(){return!0},t.prototype.update=function(n){return this.shops=n?this.shops=_.where(n,{MpName:this.name}):[]},t}(Backbone.Marionette.ItemView)}).call(this)