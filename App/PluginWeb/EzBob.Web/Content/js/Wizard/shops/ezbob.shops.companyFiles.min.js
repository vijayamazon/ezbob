(function(){var n,i={}.hasOwnProperty,t=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this;n.EzBob=n.EzBob||{};EzBob.CompanyFilesAccountModel=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.urlRoot=""+window.gRootPath+"Customer/CompanyFilesMarketPlaces/Accounts",i}(Backbone.Model);EzBob.CompanyFilesAccounts=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.model=EzBob.CompanyFilesAccountModel,i.prototype.url=""+window.gRootPath+"Customer/CompanyFilesMarketPlaces/Accounts",i}(Backbone.Collection);EzBob.CompanyFilesAccountInfoView=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click a.hmrcBack":"back","click a.connect-account":"connect"},i.prototype.initialize=function(){return this.accountType="CompanyFiles",this.template="#"+this.accountType+"AccountInfoTemplate",this.isOldInternetExplorer="Microsoft Internet Explorer"===navigator.appName&&navigator.appVersion.indexOf("MSIE 1")===-1,this.Dropzone=null},i.prototype.ui={companyFilesUploadZone:"#companyFilesUploadZone",uploadButton:".connect-account"},i.prototype.render=function(){var n;return i.__super__.render.call(this),n=this,this.initDropzone(),this},i.prototype.back=function(){return this.trigger("back"),!1},i.prototype.getDocumentTitle=function(){return EzBob.App.trigger("clear"),"Upload Company Files"},i.prototype.initDropzone=function(){var n;return this.clearDropzone(),Dropzone.options.customerFilesUploader=!1,n=this,this.Dropzone=new Dropzone(n.ui.companyFilesUploadZone[0],{init:function(){var t;t=this;({maxFilesize:10,maxFiles:10,dictFileTooBig:"File is too big, max file size is 10MB"});t.on("success",function(t,i){var r;this.getUploadingFiles().length===0&&this.getQueuedFiles().length===0&&(r=this.getAcceptedFiles()!==0,n.ui.uploadButton.toggleClass("disabled",!r));i.success?EzBob.App.trigger("info","Upload successful: "+t.name):i.error&&EzBob.App.trigger("error",i.error)});t.on("error",function(n){EzBob.App.trigger("error","Error uploading "+n.name);t.removeFile(n)});return t.on("maxfilesexceeded",function(){EzBob.App.trigger("error","You can upload up to 10 files")})}})},i.prototype.clearDropzone=function(){if(this.Dropzone)return this.Dropzone.destroy(),this.Dropzone=null},i.prototype.connect=function(){var t,n;return this.ui.uploadButton.hasClass("disabled")?!1:(t=this,BlockUi("on"),n=$.post(window.gRootPath+"CompanyFilesMarketPlaces/Connect",{customerId:this.customerId}),n.done(function(n){return n.error!==void 0?EzBob.App.trigger("error","Failed to upload company files"):EzBob.App.trigger("info","Company files uploaded successfully")}),n.always(function(){return BlockUi("off")}),this.trigger("completed"),this.trigger("back"),!1)},i}(Backbone.Marionette.ItemView)}).call(this)