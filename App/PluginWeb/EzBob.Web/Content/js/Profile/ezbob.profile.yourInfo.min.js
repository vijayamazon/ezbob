(function(){var t,i={}.hasOwnProperty,n=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};t=typeof exports!="undefined"&&exports!==null?exports:this;t.EzBob=t.EzBob||{};EzBob.Profile=EzBob.Profile||{};EzBob.Profile.YourInfoMainView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#your-info-template",i.prototype.initialize=function(){EzBob.App.on("dash-director-address-change",this.directorModelChange,this);return EzBob.App.on("add-director",this.addDirector,this)},i.prototype.events={"click .edit-personal":"editPersonalViewShow","click .submit-personal":"saveData","click .cancel":"reload","change .personEditInput":"inputChanged","keyup .personEditInput":"inputChanged"},i.prototype.ui={form:"form.editYourInfoForm"},i.prototype.setInputReadOnly=function(n){return this.$el.find(".personEditInput").attr("readonly",n).attr("modifed",!n),this.$el.find("#PersonalAddress .addAddressInput").attr("modifed",!n),n?(this.$el.find(".submit-personal, .cancel, .addAddressInput,#PersonalAddress .addAddress, .removeAddress, .attardi-input, .required").hide(),this.$el.find("textarea").removeClass("form_field").css("margin-top",0),this.$el.find(".edit-personal").show()):(this.$el.find(".submit-personal, .cancel,#PersonalAddress .removeAddress").show(),this.$el.find(".edit-personal").hide())},i.prototype.editPersonalViewShow=function(){return this.setInputReadOnly(!1)},i.prototype.addressAreValid=function(){var n,u,r,t,i,f;if(n=this.model.get("PersonalAddress"),n.length<1)return!1;if(t=this.model.get("BusinessTypeReduced"),t==="Limited"){if(n=this.model.get("CompanyAddress"),n.length<1)return!1}else if(t==="NonLimited"&&(n=this.model.get("CompanyAddress"),n.length<1))return!1;if(this.model.get(t+"Info"))for(r=this.model.get(t+"Info").Directors,i=0,f=r.length;i<f;i++)if(u=r[i],u.DirectorAddress.length<1)return!1;return!0},i.prototype.addDirector=function(){return this.ui.form.hide()},i.prototype.directorModelChange=function(n){var t;return t=this.model.get(this.model.get("BusinessTypeReduced")+"Info").Directors,_.each(t,function(t){if(t.Id===n.get("Id"))return t.DirectorAddress=n.get("DirectorAddress").models}),this.addressModelChange()},i.prototype.addressModelChange=function(){var t,i,n;return this.inputChanged(),this.setInvalidAddressLabel(this.model.get("PersonalAddress"),"#PersonalAddress"),n=this.model.get("BusinessTypeReduced"),n==="Limited"?this.setInvalidAddressLabel(this.model.get("CompanyAddress"),"#LimitedCompanyAddress"):n==="NonLimited"&&this.setInvalidAddressLabel(this.model.get("CompanyAddress"),"#NonLimitedAddress"),i=this,this.model.get(n+"Info")?(t=this.model.get(n+"Info").Directors,_.each(t,function(n){return i.setInvalidAddressLabel(n.DirectorAddress,".directorAddress"+n.Id+" #DirectorAddress",n.Id)})):void 0},i.prototype.setInvalidAddressLabel=function(n,t,i){return n.length<1?EzBob.Validation.addressErrorPlacement(this.$el.find(t),i?this.model:n,i,this.model.get("BusinessTypeReduced")):EzBob.Validation.unhighlight(this.$el.find(t))},i.prototype.saveData=function(){var i,r,u,n,t,f=this;return!this.validator.form()||!this.addressAreValid()?(EzBob.App.trigger("error","You must fill in all of the fields."),!1):(t=this.model.get("BusinessTypeReduced")+"Info",this.model.get(t)&&(u=this.model.get(t).Directors,_.each(u,function(n){return _.each(n.DirectorAddress,function(t){return t.DirectorId=n.Id})})),r=this.ui.form.serializeArray(),i=this.ui.form.attr("action"),n=$.post(i,r),n.done(function(){return f.reload(),EzBob.App.trigger("info","Your information updated successfully")}),n.fail(function(){return EzBob.App.trigger("error","Business check service temporary unavaliable, please contact with system administrator","")}))},i.prototype.reload=function(){var n=this;return this.model.fetch().done(function(){return n.render(),scrollTop(),n.setInputReadOnly(!0)})},i.prototype.regions={personal:".personal-info",company:".company-info"},i.prototype.inputChanged=function(){var n;return n=!this.validator.form()||!this.addressAreValid(),this.$el.find(".submit-personal").toggleClass("disabled",n).prop("disabled",n)},i.prototype.onRender=function(){var n;return this.renderPersonal(),n=this.model.get("BusinessTypeReduced"),n==="Limited"?this.renderLimited():n==="NonLimited"&&this.renderNonLimited(),this.setInputReadOnly(!0),this.validator=EzBob.validateYourInfoEditForm(this.ui.form),this.$el.find(".phonenumber").numericOnly(11),this.$el.find(".cashInput").numericOnly(15),$("input.form_field_right_side").css("margin-left","3px")},i.prototype.renderPersonal=function(){var n=new EzBob.Profile.PersonalInfoView({model:this.model});this.model.get("PersonalAddress").on("all",this.addressModelChange,this);return this.personal.show(n)},i.prototype.renderNonLimited=function(){var n=new EzBob.Profile.NonLimitedInfoView({model:this.model});this.model.get("CompanyAddress").on("all",this.addressModelChange,this);return this.company.show(n)},i.prototype.renderLimited=function(){var n=new EzBob.Profile.LimitedInfoView({model:this.model});this.model.get("CompanyAddress").on("all",this.addressModelChange,this);return this.company.show(n)},i}(Backbone.Marionette.Layout);EzBob.Profile.PersonalInfoView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#personal-info-template",i.prototype.regions={personAddress:"#PersonalAddress",otherPropertyAddress:"#OtherPropertyAddress"},i.prototype.onRender=function(){var n,t;return n=new EzBob.AddressView({model:this.model.get("PersonalAddress"),name:"PersonalAddress",max:10,isShowClear:!0,uiEventControlIdPrefix:this.personAddress.getEl(this.personAddress.el).attr("data-ui-event-control-id-prefix")}),this.personAddress.show(n),this.model.get("IsOffline")?(t=new EzBob.AddressView({model:this.model.get("OtherPropertyAddress"),name:"OtherPropertyAddress",max:1,isShowClear:!0,uiEventControlIdPrefix:this.otherPropertyAddress.getEl(this.otherPropertyAddress.el).attr("data-ui-event-control-id-prefix")}),this.otherPropertyAddress.show(t)):this.$el.find(".offline").remove(),this},i}(Backbone.Marionette.Layout);EzBob.Profile.NonLimitedInfoView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#nonlimited-info-template",i.prototype.regions={nonlimitedAddress:"#NonLimitedAddress",director:".director-container"},i.prototype.onRender=function(){var t,i,n;return t=new EzBob.AddressView({model:this.model.get("CompanyAddress"),name:"NonLimitedCompanyAddress",max:10,isShowClear:!0,uiEventControlIdPrefix:this.nonlimitedAddress.getEl(this.nonlimitedAddress.el).attr("data-ui-event-control-id-prefix")}),this.nonlimitedAddress.show(t),n=this.model.get("CompanyInfo").Directors,n!==null&&n.length!==0&&(i=new EzBob.Profile.DirectorCompositeView({collection:new EzBob.Directors(n)}),this.director.show(i)),this.model.get("IsOffline")?this.$el.find(".notoffline").remove():this.$el.find(".offline").remove(),this},i}(Backbone.Marionette.Layout);EzBob.Profile.LimitedInfoView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#limited-info-template",i.prototype.regions={limitedAddress:"#LimitedCompanyAddress",director:".director-container"},i.prototype.events={"click .add-director":"addDirectorClicked"},i.prototype.onRender=function(){var t,i,n;return t=new EzBob.AddressView({model:this.model.get("CompanyAddress"),name:"LimitedCompanyAddress",max:10,isShowClear:!0,uiEventControlIdPrefix:this.limitedAddress.getEl(this.limitedAddress.el).attr("data-ui-event-control-id-prefix")}),this.limitedAddress.show(t),n=this.model.get("CompanyInfo").Directors,n!==null&&n.length!==0&&(i=new EzBob.Profile.DirectorCompositeView({collection:new EzBob.Directors(n)}),this.director.show(i)),this.model.get("IsOffline")||this.$el.find(".offline").remove(),this},i.prototype.addDirectorClicked=function(){var t,n;return console.log("add director clicked"),EzBob.App.trigger("add-director"),n=$(".add-director-container"),t=(new EzBob.Profile.AddDirectorInfoView).render().$el.appendTo(n),n.show(),!1},i}(Backbone.Marionette.Layout);EzBob.Profile.DirectorInfoView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#director-info-template",i.prototype.regions={directorAddress:"#DirectorAddress"},i.prototype.addressModelChange=function(){return EzBob.App.trigger("dash-director-address-change",this.model)},i.prototype.onRender=function(){var n=new EzBob.AddressView({model:this.model.get("DirectorAddress"),name:"DirectorAddress["+this.model.get("Position")+"]",max:10,isShowClear:!0,directorId:this.model.get("Id"),uiEventControlIdPrefix:this.directorAddress.getEl(this.directorAddress.el).attr("data-ui-event-control-id-prefix")});this.model.get("DirectorAddress").on("all",this.addressModelChange,this);return this.directorAddress.show(n),this.$el.find(".addressEdit").addClass("directorAddress"+this.model.get("Id"))},i}(Backbone.Marionette.Layout);EzBob.Profile.DirectorCompositeView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#directors-info",i.prototype.itemView=EzBob.Profile.DirectorInfoView,i.prototype.itemViewContainer="div",i}(Backbone.Marionette.CompositeView);EzBob.Profile.AddDirectorInfoView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#add-director-info-template",i.prototype.initialize=function(n){return console.log("init",n)},i.prototype.events={"click .directorBack":"directorBack","click .addDirector":"directorAdd","change input":"inputChanged"},i.prototype.addressModelChange=function(){return EzBob.App.trigger("dash-director-address-change",this.model)},i.prototype.render=function(){return console.log("rendering"),i.__super__.render.call(this)},i.prototype.directorBack=function(){},i.prototype.directorAdd=function(){},i.prototype.inputChanged=function(){},i}(Backbone.Marionette.ItemView)}).call(this)