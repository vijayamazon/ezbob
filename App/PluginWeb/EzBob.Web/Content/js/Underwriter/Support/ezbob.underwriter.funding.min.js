(function(){var n,i={}.hasOwnProperty,t=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this;n.EzBob=n.EzBob||{};EzBob.Underwriter=EzBob.Underwriter||{};EzBob.Underwriter.FundingView=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.initialize=function(){var t,n=this;this.model=new EzBob.Underwriter.FundingModel;this.model.on("change reset",this.render,this);return this.requiredFunds=-1,this.model.fetch(),t=$.post(""+window.gRootPath+"Underwriter/Funding/GetAvailableFundsInterval"),t.done(function(){var t;return t=$.post(""+window.gRootPath+"Underwriter/Funding/GetRequiredFunds"),t.done(function(t){return n.requiredFunds=t,n.render(),n.modelUpdater=setInterval(function(){return n.model.fetch()},t)})})},i.prototype.template="#funding-template",i.prototype.events={"click #addFundsBtn":"addFunds","click #cancelManuallyAddedFundsBtn":"cancelManuallyAddedFunds"},i.prototype.addFunds=function(){var n,t;t=this;n=new EzBob.Dialogs.PacentManual({model:this.model,title:"Pacnet Balance - Add Manual Funds",width:400,postValueName:"amount",url:"Underwriter/Funding/SavePacnetManual",data:{limit:EzBob.Config.PacnetBalanceMaxManualChange},min:EzBob.Config.PacnetBalanceMaxManualChange*-1,max:EzBob.Config.PacnetBalanceMaxManualChange,required:!0});n.render();return n.on("done",function(){return t.model.fetch()})},i.prototype.cancelManuallyAddedFunds=function(){var n,t;t=this;n=new EzBob.Dialogs.CheckBoxEdit({model:this.model,propertyName:"UseSetupFee",title:"Pacnet Balance - Clear Manual Funds",width:400,checkboxName:"I am sure",postValueName:"isSure",url:"Underwriter/Funding/DisableCurrentManualPacnetDeposits",data:{isSure:this.model.get("IsSure")}});n.render();return n.on("done",function(){return t.model.fetch()})},i.prototype.onRender=function(){var r,n,t,i;return $("body").hasClass("role-manager")||(this.$el.find("#addFundsBtn").hide(),this.$el.find("#cancelManuallyAddedFundsBtn").hide()),n=$("[id='liFunding']"),t=$("[id='available-funds-td-header']"),i=$("[id='available-funds-td-value']"),r=this.model.get("AvailableFunds"),this.requiredFunds>r?(n.addClass("available-funds-alert"),t.addClass("available-funds-alert-text-color"),i.addClass("available-funds-alert-text-color")):(n.removeClass("available-funds-alert"),t.removeClass("available-funds-alert-text-color"),i.removeClass("available-funds-alert-text-color"))},i.prototype.hide=function(){return this.$el.hide()},i.prototype.show=function(){return this.$el.show()},i.prototype.serializeData=function(){return{model:this.model}},i}(Backbone.Marionette.ItemView);EzBob.Underwriter.FundingModel=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.urlRoot=function(){return""+gRootPath+"Underwriter/Funding/GetCurrentFundingStatus"},i}(Backbone.Model)}).call(this)