(function(){var n,t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this,n.EzBob=n.EzBob||{},EzBob.Underwriter=EzBob.Underwriter||{},EzBob.Underwriter.CreditLineDialog=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,n),t.prototype.template="#credit-line-dialog-template",t.prototype.initialize=function(){return this.cloneModel=this.model.clone(),this.modelBinder=new Backbone.ModelBinder},t.prototype.events={"click .btnOk":"save"},t.prototype.ui={form:"form"},t.prototype.save=function(){var n,t,i,r=this;if(this.ui.form.valid())return i=this.serializeData(),n=""+window.gRootPath+"Underwriter/ApplicationInfo/ChangeCreditLine",t=$.post(n,i),t.done(function(){return r.model.fetch()}),this.close()},t.prototype.serializeData=function(){var n;return n=this.cloneModel.toJSON(),{id:n.CashRequestId,loanType:n.LoanTypeId,amount:n.OfferedCreditLine,interestRate:n.InterestRate,repaymentPeriod:n.RepaymentPerion,offerStart:n.StartingFromDate,offerValidUntil:n.OfferValidateUntil,useSetupFee:n.UseSetupFee}},t.prototype.bindings={OfferedCreditLine:{selector:"input[name='offeredCreditLine']"},InterestRate:{selector:"input[name='interestRate']",converter:EzBob.BidingConverters.percents},RepaymentPerion:{selector:"input[name='repaymentPeriod']"},StartingFromDate:{selector:"input[name='startingFromDate']"},OfferValidateUntil:{selector:"input[name='offerValidUntil']"},UseSetupFee:{selector:"input[name='enableSetupFee']"}},t.prototype.onRender=function(){return this.modelBinder.bind(this.cloneModel,this.el,this.bindings),this.$el.find("#startingFromDate, #offerValidUntil").datepicker({autoclose:!0,format:"dd/mm/yyyy"}).datepicker("show"),this.$el.find("#offeredCreditLine").autoNumeric(EzBob.moneyFormat),this.$el.find("#interestRate").autoNumeric(EzBob.percentFormat),this.setValidator()},t.prototype.setValidator=function(){return this.ui.form.validate({rules:{offeredCreditLine:{required:!0,autonumericMin:EzBob.Config.XMinLoan,autonumericMax:EzBob.Config.MaxLoan},repaymentPeriod:{required:!0,autonumericMin:1,autonumericMax:100},interestRate:{required:!0,min:1,max:100},startingFromDate:{required:!0,dateCheck:!0},offerValidUntil:{required:!0,dateCheck:!0}},errorPlacement:EzBob.Validation.errorPlacement,unhighlight:EzBob.Validation.unhighlight})},t}(Backbone.Marionette.ItemView)}).call(this)