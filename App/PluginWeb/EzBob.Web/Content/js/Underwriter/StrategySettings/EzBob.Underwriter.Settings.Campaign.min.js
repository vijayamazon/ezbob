(function(){var n,i={}.hasOwnProperty,t=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this,n.EzBob=n.EzBob||{},EzBob.Underwriter=EzBob.Underwriter||{},EzBob.Underwriter.Settings=EzBob.Underwriter.Settings||{},EzBob.Underwriter.Settings.CampaignModel=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.url=window.gRootPath+"Underwriter/StrategySettings/SettingsCampaign",i}(Backbone.Model),EzBob.Underwriter.Settings.CampaignView=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.template="#campaign-settings-template",i.prototype.initialize=function(){this.model.on("reset",this.render,this);return this.update(),this},i.prototype.events={"click .addCampaign":"addCampaign","click .campaignCustomers":"campaignCustomers"},i.prototype.campaignCustomers=function(n){return console.log(n,$(n)),EzBob.ShowMessage($(n.currentTarget).attr("data-campaign-clients"),"Campaign clients",null,"OK")},i.prototype.addCampaign=function(){BlockUi("On"),this.addCampaignView=new EzBob.Underwriter.Settings.AddCampaignView({model:this.model});this.addCampaignView.on("campaign-added",this.update,this);return EzBob.App.jqmodal.show(this.addCampaignView),BlockUi("Off")},i.prototype.serializeData=function(){var n;return n={campaigns:this.model.get("campaigns")},console.log("ser",n),n},i.prototype.update=function(){var n=this;return console.log("update"),this.addCampaignView&&EzBob.App.jqmodal.hideModal(this.addCampaignView),console.log("update2"),this.model.fetch().done(function(){return console.log("@model",n.model),n.render()}),console.log("update3")},i.prototype.onRender=function(){return console.log("render"),$("body").hasClass("role-manager")?void 0:(this.$el.find("select").addClass("disabled").attr({readonly:"readonly",disabled:"disabled"}),this.$el.find("button").hide())},i.prototype.show=function(){return this.$el.show()},i.prototype.hide=function(){return this.$el.hide()},i.prototype.onClose=function(){},i}(Backbone.Marionette.ItemView),EzBob.Underwriter.Settings.AddCampaignView=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.template="#add-campaign-template",i.prototype.initialize=function(){this.model.on("reset",this.render,this);return this.update(),this},i.prototype.events={"click .addCampaignBtn":"addCampaign"},i.prototype.ui={form:"form"},i.prototype.addCampaign=function(){var i,n,r,t,u=this;return BlockUi("on"),i=this.ui.form.serialize(),console.log(i),r=this,n=function(){return r.trigger("campaign-added")},t=$.post(""+window.gRootPath+"Underwriter/StrategySettings/AddCampaign/?"+i),t.done(function(t){if(console.log("res",t),!t.success){EzBob.ShowMessage("Failed to add the campaign. "+t.error,"Failure",n,"OK");return}return EzBob.ShowMessage("Successfully Added. "+t.error,"The campaign added successfully.",n,"OK")}),t.fail(function(){return EzBob.ShowMessage("Failed to add the campaign. ","Failure",n,"OK")}),t.always(function(){return BlockUi("off")}),!1},i.prototype.update=function(){var n,t=this;return n=this.model.fetch(),n.done(function(){return t.render()})},i.prototype.onRender=function(){return this.$el.find("input.date").datepicker({format:"dd/mm/yyyy"}),this.$el.find("input[data-content], span[data-content]").setPopover()},i.prototype.jqoptions=function(){return{modal:!0,resizable:!1,title:"Add campaign",position:"center",draggable:!1,width:"40%",height:670,dialogClass:"addCampaign"}},i.prototype.serializeData=function(){return{campaignTypes:this.model.get("campaignTypes")}},i}(Backbone.Marionette.ItemView)}).call(this)