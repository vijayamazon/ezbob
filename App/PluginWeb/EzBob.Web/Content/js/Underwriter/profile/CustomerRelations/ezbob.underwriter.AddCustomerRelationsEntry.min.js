(function(){var n,t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this;n.EzBob=n.EzBob||{};EzBob.Underwriter=EzBob.Underwriter||{};EzBob.Underwriter.AddCustomerRelationsEntry=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,n),t.prototype.template="#add-customer-relations-entry-template",t.prototype.events={"keyup #Comment":"commentKeyup"},t.prototype.jqoptions=function(){return{modal:!0,resizable:!0,title:"CRM - add entry",position:"center",draggable:!0,dialogClass:"customer-relations-popup",width:600}},t.prototype.initialize=function(n){return this.onsave=n.onsave,this.onbeforesave=n.onbeforesave,this.customerId=this.model.customerId,this.url=window.gRootPath+"Underwriter/CustomerRelations/SaveEntry/",t.__super__.initialize.call(this)},t.prototype.onRender=function(){return this.ui.Action.prop("selectedIndex",1)},t.prototype.serializeData=function(){return{actions:EzBob.CrmActions,statuses:EzBob.CrmStatuses,ranks:EzBob.CrmRanks}},t.prototype.commentKeyup=function(){return this.ui.Comment.val(this.ui.Comment.val().replace(/\r\n|\r|\n/g,"\r\n").slice(0,1e3))},t.prototype.ui={Incoming:"#Incoming_I",Status:"#Status",Action:"#Action",Rank:"#Rank",Comment:"#Comment"},t.prototype.onSave=function(){var n,t,i=this;if(this.ui.Status[0].selectedIndex===0||this.ui.Action[0].selectedIndex===0||this.ui.Rank[0].selectedIndex===0)return!1;if(BlockUi(),n={isIncoming:this.ui.Incoming[0].checked,action:this.ui.Action[0].value,status:this.ui.Status[0].value,rank:this.ui.Rank[0].value,comment:this.ui.Comment.val(),customerId:this.customerId},this.onbeforesave)this.onbeforesave(n);return t=$.post(this.url,n),t.done(function(n){return n.success?i.model.fetch():n.error&&EzBob.ShowMessage(n.error,"Error"),i.close()}),t.always(function(){return UnBlockUi()}),!1},t}(EzBob.BoundItemView)}).call(this)