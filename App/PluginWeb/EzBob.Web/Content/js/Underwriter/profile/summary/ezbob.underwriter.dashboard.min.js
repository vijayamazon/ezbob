(function(){var n,t={}.hasOwnProperty,i=function(n,i){function u(){this.constructor=n}for(var r in i)t.call(i,r)&&(n[r]=i[r]);return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n};n=typeof exports!="undefined"&&exports!==null?exports:this;n.EzBob=n.EzBob||{};EzBob.Underwriter=EzBob.Underwriter||{};EzBob.Underwriter.DashboardView=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,n),t.prototype.template="#dashboard-template",t.prototype.initialize=function(n){return this.crmModel=n.crmModel,this.personalModel=n.personalModel,this.experianModel=n.experianModel,this.propertiesModel=n.propertiesModel,this.mpsModel=n.mpsModel,this.loanModel=n.loanModel,this.bindTo(this.model,"change sync",this.render,this),this.bindTo(this.crmModel,"change sync",this.render,this),this.bindTo(this.personalModel,"change sync",this.render,this),this.bindTo(this.experianModel,"change sync",this.render,this),this.bindTo(this.propertiesModel,"change sync",this.render,this),this.bindTo(this.mpsModel,"change sync",this.render,this),this.bindTo(this.loanModel,"change sync",this.render,this)},t.prototype.serializeData=function(){return{m:this.model.toJSON(),crm:_.first(_.filter(this.crmModel.toJSON(),function(n){return n.User!=="System"}),5),experian:this.experianModel.toJSON(),properties:this.propertiesModel.toJSON(),mps:this.mpsModel.toJSON(),loan:this.loanModel.toJSON(),affordability:null}},t.prototype.events={'click a[data-action="collapse"]':"boxToolClick",'click a[data-action="close"]':"boxToolClick"},t.prototype.boxToolClick=function(n){var r,i,t;t=n.currentTarget;$(t).data("action")===undefined&&!1;r=$(t).data("action");i=$(t);switch(r){case"collapse":$(i).children("i").addClass("anim-turn180");$(t).parents(".box").children(".box-content").slideToggle(500,function(){return $(this).is(":hidden")?$(i).children("i").attr("class","fa fa-chevron-down"):$(i).children("i").attr("class","fa fa-chevron-up"),!1});break;case"close":$(t).parents(".box").fadeOut(500,function(){return $(this).parent().remove(),!1});break;case"config":$("#"+$(t).data("modal")).modal("show")}return!1},t.prototype.onRender=function(){var t,i,n;return this.experianModel&&this.experianModel.get("ConsumerHistory")&&(n=_.sortBy(this.experianModel.get("ConsumerHistory"),function(n){return n.Date}),i=_.pluck(n,"Score").join(","),this.$el.find(".consumerScoreGraph").attr("values",i)),this.experianModel&&this.experianModel.get("CompanyHistory")&&(n=_.sortBy(this.experianModel.get("CompanyHistory"),function(n){return n.Date}),t=_.pluck(n,"Score").join(","),this.$el.find(".companyScoreGraph").attr("values",t)),this.$el.find(".inline-sparkline").sparkline("html",{width:"100%",height:"100%",lineWidth:2,spotRadius:3,lineColor:"#88bbc8",fillColor:"#f2f7f9",spotColor:"#14ae48",maxSpotColor:"#e72828",minSpotColor:"#f7941d",valueSpots:{":549":"red","550:749":"yellow","750:":"green"}})},t}(Backbone.Marionette.ItemView)}).call(this)