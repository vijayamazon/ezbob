(function(){var t,i={}.hasOwnProperty,n=function(n,t){function u(){this.constructor=n}for(var r in t)i.call(t,r)&&(n[r]=t[r]);return u.prototype=t.prototype,n.prototype=new u,n.__super__=t.prototype,n};t=typeof exports!="undefined"&&exports!==null?exports:this;t.EzBob=t.EzBob||{};EzBob.Underwriter=EzBob.Underwriter||{};EzBob.Underwriter.BugModel=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.url=function(){return""+window.gRootPath+"Underwriter/Bugs/Report"},i.prototype.idAttribute="Id",i.prototype.defaults={TextOpened:"",Type:"Other",DateOpened:new Date,State:"Opened",MarketPlaceId:null},i.prototype.save=function(){return this.isNew()?i.__super__.save.call(this,{},{url:""+window.gRootPath+"Underwriter/Bugs/CreateBug"}):i.__super__.save.call(this,{},{url:""+window.gRootPath+"Underwriter/Bugs/UpdateBug"})},i}(Backbone.Model);EzBob.Underwriter.Bugs=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.model=EzBob.Underwriter.BugModel,i}(Backbone.Collection);EzBob.Underwriter.ReportBugView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="#bug-report-template",i.prototype.events={'click  [data-dismiss="modal"]':"closed"},i.prototype.bindings={TextOpened:{selector:"textarea[name='description']"}},i.prototype.closed=function(){return this.trigger("closed")},i}(EzBob.BoundItemView);EzBob.Underwriter.EditBugView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.events={"click .btn-danger":"closeBug","click .btn-warning":"reopenBug",'click  [data-dismiss="modal"]':"closed"},i.prototype.template="#bug-edit-template",i.prototype.jqoptions=function(){return{modal:!0,resizable:!1,title:"Bug Reporter",position:"center",draggable:!1,width:"73%",height:Math.max(window.innerHeight*.9,600),dialogClass:"bugs-popup"}},i.prototype.eqConverter=function(n){return function(t,i){return i===n}},i.prototype.notEqConverter=function(n){return function(t,i){return i!==n}},i.prototype.bindings={TextOpened:{selector:"textarea[name='description']"},TextClosed:{selector:"textarea[name='closeDescription']"},State:[{selector:"textarea",converter:i.prototype.notEqConverter("Closed"),elAttribute:"enabled"},{selector:".btn-danger",converter:i.prototype.notEqConverter("Closed"),elAttribute:"displayed"},{selector:".underwriter-closed",converter:i.prototype.eqConverter("Closed"),elAttribute:"displayed"},{selector:".btn-warning",converter:i.prototype.eqConverter("Closed"),elAttribute:"displayed"},{selector:".btn-primary",converter:i.prototype.notEqConverter("Closed"),elAttribute:"enabled"}]},i.prototype.closeBug=function(){return this.trigger("closeBug"),this.close()},i.prototype.reopenBug=function(){return this.trigger("reopenBug")},i.prototype.closed=function(){return this.trigger("closed")},i}(EzBob.BoundItemView);$("body").on("click","a[data-bug-type]",function(n){var t,i,u,r,f,e,o=this;return(t=$(n.currentTarget),r=t.data("bug-type"),u=t.data("bug-mp"),i=t.data("bug-customer"),f=t.data("credit-bureau-director-id"),!(r!=null&&i!=null))?!1:(e=$.getJSON(""+window.gRootPath+"Underwriter/Bugs/TryGet",{MP:u,CustomerId:i,BugType:r,Director:f}),e.done(function(n){var o,e;if(n!=null?!n.error:!void 0){if(e=null,o=null,n!=null?n.Id:void 0){o=new EzBob.Underwriter.BugModel(n);e=new EzBob.Underwriter.EditBugView({model:o});e.on("closeBug",function(){var n;return n=$.post(""+window.gRootPath+"Underwriter/Bugs/Close",o.toJSON()),n.done(function(n){return EzBob.UpdateBugsIcon(t,n.State),e.close()})});e.on("reopenBug",function(){var n;return n=$.post(""+window.gRootPath+"Underwriter/Bugs/Reopen",o.toJSON()),n.done(function(n){return o=new EzBob.Underwriter.BugModel(n),e.model=o,e.render(),EzBob.UpdateBugsIcon(t,n.State)})});e.on("closed",function(){return EzBob.UpdateBugsIcon(t,o.get("State"))})}else{o=new EzBob.Underwriter.BugModel({Type:r,CustomerId:i,MarketPlaceId:u,DirectorId:f});e=new EzBob.Underwriter.ReportBugView({model:o});EzBob.UpdateBugsIcon(t,o.get("State"));e.on("closed",function(){return EzBob.UpdateBugsIcon(t,"New")})}e.on("save",function(){return o.get("State")!=="Closed"&&o.save(),e.close()});return e.options={show:!0,keyboard:!1,focusOn:"textarea:first"},EzBob.App.jqmodal.show(e)}}),!1)})}).call(this)