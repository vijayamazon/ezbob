<?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=152368
  -->

<configuration>
  <configSections>
    <section name="syscache2" type="NHibernate.Caches.SysCache2.SysCacheSection, NHibernate.Caches.SysCache2" />
    <section name="ClickTale.IntegrationModuleSettings" type="System.Configuration.SingleTagSectionHandler" />
  </configSections>
  <appSettings>
    <add key="webpages:Version" value="1.0.0.0" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />

    <!--CaptchaPass is any string.-->
    <!--CaptchaSalt is Base64String-->
    <!--*****************************************************-->
    <add key="CaptchaPass" value="EzBobScortoEncryptionPass" />
    <add key="CaptchaSalt" value="QmFzZTY0S2Fzc2EzNjVFbmNyeXB0aW9u" />
    <add key="CaptchaChars" value="0123456789" />
    <add key="DefaultCaptchaManager" value="EzBob.Web.Infrastructure.EzbobCaptchaManager, ezbob.web"/>
    <!--*****************************************************-->
  </appSettings>
    
  <system.web>
    <httpRuntime enableVersionHeader="false" />

    <sessionState cookieName="EzBobSessionId" />
    
    <globalization 
      culture="en-US" 
      uiCulture="en-US" 
      fileEncoding="utf-8"
      requestEncoding="utf-8"
      responseEncoding=""
    />
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="Forms">
      <forms loginUrl="~/Account/Logon" timeout="25" slidingExpiration="true" requireSSL="true" name="EzBobAuth" />
    </authentication>

    <customErrors mode="RemoteOnly" defaultRedirect="~/Error/Error">
      <error redirect="~/Error/NotFound" statusCode="404" />
    </customErrors>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />        
      </namespaces>
    </pages>
    <membership defaultProvider="SimpleMembershipProvider">
      <providers>
        <add name="SimpleMembershipProvider" type="EzBob.Web.Infrastructure.ScortoMembershipProvider" />
      </providers>
    </membership>
    <roleManager enabled="true" defaultProvider="ScortoRoleProvider"> 
      <providers> 
        <add name="ScortoRoleProvider" type="EzBob.Web.Infrastructure.ScortoRoleProvider" /> 
      </providers> 
    </roleManager>
  </system.web>

  <syscache2>
    <cacheRegion name="DbStrings" relativeExpiration="12000" />
    <cacheRegion name="Longest" relativeExpiration="3" />
    <cacheRegion name="LongTerm" relativeExpiration="3" />
    <cacheRegion name="VeryShort" relativeExpiration="3" />
  </syscache2>

  <ClickTale.IntegrationModuleSettings
    ScriptsFile="~\ClickTaleScripts.xml"
    DoNotProcessCookieName="WRUID"
    DoNotProcessCookieValue ="0"
    MaxCachedPages="100"
    AllowedAddresses ="75.125.82.64/26 50.97.162.64/26"/>
  <!-- note, this stands for 75.125.82.64 - 75.125.82.127 and 50.97.162.64 - 50.97.162.127 -->

  <system.webServer>
    <handlers>
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
    <httpProtocol>
      <customHeaders>
        <remove name="X-Powered-By" />
        <add name="X-UA-Compatible" value="IE=Edge,chrome=1" />
      </customHeaders>
    </httpProtocol>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true">
      <!-- <add name="ClickTaleIntegrationModule" type="ClickTale.IntegrationModule.ClickTaleIntegrationModule" preCondition="managedHandler" /> -->
      <add name="NoIISHeaderModule" type="EzBob.Web.Infrastructure.NoIISHeaderModule" />
      <add name="XFrameOptionsModule" type="EzBob.Web.Infrastructure.XFrameOptionsModule" />
    </modules>
    <httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
      <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" />
      <dynamicTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/javascript" enabled="true" />
        <add mimeType="*/*" enabled="false" />
      </dynamicTypes>
      <staticTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/javascript" enabled="true" />
        <add mimeType="*/*" enabled="false" />
      </staticTypes>
    </httpCompression>
    <urlCompression doStaticCompression="true" doDynamicCompression="true" />
      <directoryBrowse enabled="false" />
      <rewrite>
          <rules>
			      <rule name="HTTP to HTTPS redirect" stopProcessing="true">
				      <match url="(.*)" />
				      <conditions>
					      <add input="{HTTPS}" pattern="off" ignoreCase="true" />
				      </conditions>
				      <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
			      </rule>
          </rules>
      </rewrite>
      <staticContent>
        <remove fileExtension=".mp4" />
        <remove fileExtension=".webm" />
        <remove fileExtension=".ogg" />
        <remove fileExtension=".ogv" />
        <mimeMap fileExtension=".mp4" mimeType="video/mp4" />
        <mimeMap fileExtension=".webm" mimeType="video/webm" />
        <mimeMap fileExtension=".ogg" mimeType="video/ogg" />
        <mimeMap fileExtension=".ogv" mimeType="video/ogv" />
      </staticContent>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  
</configuration>
