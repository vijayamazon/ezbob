@using System.Collections.Generic
@using ConfigManager
@using EzBob.Web.Infrastructure
@using EzBob.Web.Infrastructure.Html
@model EzBob.Web.Models.ForgotPasswordModel
@section head
{
	<meta name="description" content="Recover your EZBOB business loan account password." />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
}

@section css{
	@BundleHelper.RenderLoginCss()
}

@{
	var mail = Model == null ? "" : Model.Email;
	string captchamode = CurrentValues.Instance.CaptchaMode;

	UiCustomerOrigin.Set(ViewBag);
	var origin = ViewBag.CustomerOrigin.GetOrigin();
	ViewBag.Title = "Password recovery - " + ViewBag.CustomerOrigin.Name;
}
<div class="row-fluid">
	<div class="inner">
		<div class="wizard-wrap">
			<div class="wizard-inner-wrap">
				<div class="pass-restore"></div>
			</div>
		</div>
	</div>
</div>


<script type="text/template" id="restore-pass-template">
	<section id="content">
		<div class="errorArea"></div>
		<section class="pages">
			<h2>Password recovery</h2>
			<div class="restorePasswordArea">
				@using (Html.BeginForm()) {
					<div>
						@EzForm.InputTextWizard(new EzInputBuilder("email", "Email address",
							type: "email",
							cls: "email form_field",
							isRequired: true,
							statusIcon: true,
							uiEventControlID: "restore-password:email",
							tabIndex: 10,
							autoCorrect: "off",
							autoCapitalize: "off",
							maxLength: 128), origin: origin)
						
						@EzForm.Captcha(captchamode, origin: origin)
						
						<div class="form_buttons_container">
							<div class="attardi-button">
								<input class="button btn-green continue disabled" type="button" id="getQuestion" value="Continue" tabindex="12" ui-event-control-id="restore-password:get_question" />
							</div>
						</div>
						<div id="questionArea" style="display: none;">
							@EzForm.InputTextArea("questionField", "Security question", cls: "form_field", origin: origin)
							
							@EzForm.InputTextWizard(new EzInputBuilder("Answer", "Security answer",
								cls: "form_field",
								isRequired: true,
								statusIcon: true,
								uiEventControlID: "restore-password:answer",
								tabIndex: 10,
								autoCorrect: "off",
								autoCapitalize: "off",
								maxLength: 128), origin: origin)

							<div class="form_buttons_container">
								<div class="attardi-button">
									<input class="button btn-green continue disabled" type="button" id="restore" value="Continue" tabindex="12" ui-event-control-id="restore-password:submit" />
								</div>
							</div>
						</div>
					</div>
				}
			</div>
			<div class="passwordRestoredArea" style="display: none;">
				<h2>A new password was sent to your email</h2>
				<div class="form_buttons_container">
					<div class="attardi-button">
						<a href="@Url.Action("LogOn", "Account")" class="btn-continue button btn-green" ui-event-control-id="restore-password:login">Finish</a>
					</div>
				</div>
			</div>
		</section>
	</section>
	<aside class="customer-sidebar forgot-password">
		@{Html.RenderPartial("~/Areas/Customer/Views/Shared/SideBars/_Sidebar.cshtml");}
	</aside>
	<div class="clear"></div>
</script>

@section Js{
	<script type="text/javascript" src='@Url.Content("~/Content/js/controls/ezbob.notifications.js")'></script>
	<script type="text/javascript">

		EzBob.Config.CaptchaMode = '@ViewData["CaptchaMode"]';
		SetCaptchaMode();
		var passEmailView = new EzBob.ResetPasswordView({ el: $(".pass-restore") });
		passEmailView.render();
	</script>
}
