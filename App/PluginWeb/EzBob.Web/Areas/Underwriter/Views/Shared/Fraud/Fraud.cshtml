@using EzBob.Web.Areas.Underwriter.Models.Fraud

<script type="text/template" id="fraud-template">
    <div class="left">
        <button class="add btn btn-success btn-small"><i class="icon-plus"></i>Add new fraud user</button>
        <button class="internal btn btn-success btn-small"><i class="icon-plus"></i>Test internal check(using for debug)</button>
        <button class="external btn btn-success btn-small"><i class="icon-plus"></i>Test external check(using for debug)</button>
        <button class="all btn btn-success btn-small"><i class="icon-plus"></i>Test all check(using for debug)</button>
    </div>

    <table class="table table-striped table-bordered blue-header">
        <thead>
            @EzForm.RawHeaderCell("Fraud", "", "", "", "", "", "", "")
        </thead>
        <tbody>
            @EzForm.RawCellBold("Name", "Addresses", "Phones", "Emails", "Email Domains", "Bank Accounts", "Companies", "Shops")
            <%_.each(data, function(val){ %> 
            <%
            function PrepareOutput(data){
                var retVal = "";
                _.each(data, function(value, i){
                    retVal+= i+1 + ') ' +_.values(value).clean(0).clean(null) + ' <br />'; 
                });
                return retVal.isNullOrEmpty() ? "-" : retVal;
            }
            %>
            @EzForm.RawCell(
            "<%-val.FirstName%> <%-val.LastName%>",
            "<%=PrepareOutput(val.Addresses)%>",
            "<%=PrepareOutput(val.Phones)%>",
            "<%=PrepareOutput(val.Emails)%>",
            "<%=PrepareOutput(val.EmailDomains)%>",
            "<%=PrepareOutput(val.BankAccounts)%>",
            "<%=PrepareOutput(val.Companies)%>",
            "<%=PrepareOutput(val.Shops)%>"
            )
            <%})%>
        </tbody>
    </table>
</script>

<script type="text/template" id="fraud-add-edit-template">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Add new fraud user</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" action="/" method="post">
            <h5>Fraud name</h5>
            @EzForm.InputTextUnderwriter("FirstName", "First Name", "")
            @EzForm.InputTextUnderwriter("LastName", "Last Name", "")
            <hr/>

            <h5>Fraud Addresses</h5>
            <div class="Addresses"></div>
            <button class="btn-mini btn btn-success add" data-type="Addresses"><i class="icon-plus"></i></button>
            <hr/>

            <h5>Fraud Phones</h5>
            <div class="Phones"></div>
            <button class="btn-mini btn btn-success add" data-type="Phones"><i class="icon-plus"></i></button>
            <hr/>

            <h5>Fraud Emails</h5>
            <div class="Emails"></div>
            <button class="btn-mini btn btn-success add" data-type="Emails"><i class="icon-plus"></i></button>
            <hr/>

            <h5>Fraud Email Domains</h5>
            <div class="EmailDomains"></div>
            <button class="btn-mini btn btn-success add" data-type="EmailDomains"><i class="icon-plus"></i></button>
            <hr/>

            <h5>Fraud Bank Accounts</h5>
            <div class="BankAccounts"></div>
            <button class="btn-mini btn btn-success add" data-type="BankAccounts"><i class="icon-plus"></i></button>
            <hr/>
            
            <h5>Fraud Companies</h5>
            <div class="Companies"></div>
            <button class="btn-mini btn btn-success add" data-type="Companies"><i class="icon-plus"></i></button>
            <hr/>

            <h5>Fraud Shops</h5>
            <div class="Shops"></div>
            <button class="btn-mini btn btn-success add" data-type="Shops"><i class="icon-plus"></i></button>
            <hr/>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary save">Save</button>
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</script>

@helper AddValuesModal(string caption, IEnumerable<InputValuesModel> values)
{
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3>@caption</h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal">
            @foreach (var val in values)
            {
                if (val.IsCombobox)
                {
                    @EzForm.SelectAdvanced(val.Id, val.Caption, val.MpType.ToDictionary(key => key.Name, value=>value.Name), "","selectheight ")
                }
                else
                {
                    @EzForm.InputText(val.Id, val.Caption, val.Value)
                }
            }
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary ok">Add</button>
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
}

@helper SimpleValues(string caption, string type)
{
    <text>
        <%_.each(models, function(val, i){%>
        <div class="control-group">
            <label class="control-label" for="@caption<%-i%>">@caption <%-i+1%></label>
            <div class="controls">
                <%if(_.keys(val).length>1){%>
                <textarea  disabled="disabled" style="resize: none"><%-_.values(val).clean("")%></textarea>
                <%}else{%>
                <input type="text"  disabled="disabled" value="<%-_.values(val)%>">
                <%}%>
                <button class="btn btn-mini btn-danger remove" data-index="<%-i%>" data-type="@type"><i class="icon-remove"></i></button>
            </div>
        </div>
        <%});%>
    </text>
}
<script type="text/template" id="Addresses-template">
    @SimpleValues("Address", "Addresses")
</script>

<script type="text/template" id="Phones-template">
    @SimpleValues("Phones", "Phones")
</script>

<script type="text/template" id="Emails-template">
    @SimpleValues("Email", "Emails")
</script>

<script type="text/template" id="EmailDomains-template">
    @SimpleValues("Email Domain", "EmailDomains")
</script>

<script type="text/template" id="BankAccounts-template">
    @SimpleValues("Bank Account", "BankAccounts")
</script>

<script type="text/template" id="Companies-template">
    @SimpleValues("Company", "Companies")
</script>

<script type="text/template" id="Shops-template">
    @SimpleValues("Shops", "Shops")
</script>

<script type="text/template" id="add-Addresses-template">
    @AddValuesModal("Add Fraud Addresses", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Postcode",
                    Id = "Postcode",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "Address Line1",
                    Id = "Line1",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "Address Line2",
                    Id = "Line2",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "Address Line3",
                    Id = "Line3",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "Town",
                    Id = "Town",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "County",
                    Id = "County",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-Phones-template">
    @AddValuesModal("Add Fraud Phone", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Phone",
                    Id = "PhoneNumber",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-Emails-template">
    @AddValuesModal("Add Fraud Email", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Email",
                    Id = "Email",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-EmailDomains-template">
    @AddValuesModal("Add Fraud Email Domain", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Email",
                    Id = "EmailDomain",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-BankAccounts-template">
    @AddValuesModal("Add Fraud Bank Accounts", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Bank Account",
                    Id = "BankAccount",
                    Value = ""
                },
            new InputValuesModel
                {
                    Caption = "Sort Code",
                    Id = "SortCode",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-Companies-template">
    @AddValuesModal("Add Fraud Company", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Company Name",
                    Id = "CompanyName",
                    Value = ""
                },
             new InputValuesModel
                {
                    Caption = "Registration Number",
                    Id = "RegistrationNumber",
                    Value = ""
                }
        })
</script>

<script type="text/template" id="add-Shops-template">
    @AddValuesModal("Add Fraud Shop", new List<InputValuesModel>
        {
            new InputValuesModel
                {
                    Caption = "Shop Name",
                    Id = "Name",
                    Value = ""
                },
             new InputValuesModel
                {
                    Caption = "Shop Type",
                    Id = "Type",
                    Value = "",
                    IsCombobox = true,
                    MpType = Model.MpTypes
                }
        })
</script>