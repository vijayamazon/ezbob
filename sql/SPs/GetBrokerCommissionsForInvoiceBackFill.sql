IF OBJECT_ID('GetBrokerCommissionsForInvoiceBackFill') IS NULL 
	EXECUTE('CREATE PROCEDURE GetBrokerCommissionsForInvoiceBackFill AS SELECT 1')
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE GetBrokerCommissionsForInvoiceBackFill
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @t AS TABLE (LoanBrokerCommissionID INT)

	INSERT INTO @t(LoanBrokerCommissionID) VALUES
		(275), (17), (228), (149), (4), (243), (261), (161), (98), (185), (231), (155), (297),
		(156), (133), (254), (264), (268), (31), (290), (101), (186), (71), (350), (62), (47),
		(118), (190), (177), (151), (132), (250), (158), (28), (295), (166), (115), (319), (167),
		(126), (129), (224), (117), (339), (343), (229), (130), (116), (60), (338), (326), (222),
		(165), (157), (248), (335), (211), (146), (353), (256), (2), (66), (140), (20), (347),
		(329), (327), (220), (57), (148), (9), (3), (6), (5), (34), (1), (16), (33), (14), (76),
		(40), (7), (43), (13), (21), (109), (12), (204), (10), (11), (8), (48), (283), (90),
		(18), (15), (19), (142), (22), (23), (52), (24), (35), (25), (26), (93), (30), (27),
		(53), (32), (38), (29), (36), (45), (196), (37), (64), (55), (72), (41), (39), (42),
		(46), (59), (61), (44), (88), (50), (49), (56), (65), (58), (83), (106), (112), (51),
		(54), (135), (63), (67), (81), (68), (113), (69), (70), (92), (73), (75), (77), (74),
		(78), (164), (84), (80), (85), (86), (91), (79), (213), (100), (94), (82), (89), (289),
		(87), (122), (96), (95), (97), (107), (282), (160), (104), (102), (103), (99), (108),
		(105), (134), (110), (114), (121), (111), (123), (125), (120), (119), (147), (145),
		(124), (128), (127), (141), (172), (202), (169), (131), (144), (136), (191), (139),
		(137), (138), (143), (187), (154), (225), (153), (150), (152), (170), (255), (159),
		(188), (189), (328), (174), (171), (168), (178), (184), (199), (179), (176), (183),
		(175), (173), (193), (197), (194), (212), (198), (216), (192), (203), (195), (237),
		(208), (200), (206), (278), (214), (201), (217), (232), (205), (280), (215), (221),
		(245), (210), (207), (247), (209), (223), (219), (218), (227), (287), (270), (249),
		(236), (253), (240), (226), (233), (281), (298), (230), (251), (234), (235), (258),
		(238), (239), (252), (246), (244), (241), (242), (288), (266), (257), (260), (259),
		(262), (263), (271), (277), (267), (272), (307), (265), (284), (269), (274), (279),
		(276), (273), (291), (285), (294), (301), (323), (296), (300), (292), (302), (293),
		(304), (315), (306), (317), (305), (299), (316), (303), (312), (331), (332), (333),
		(334), (311), (308), (314), (309), (341), (345), (310), (320), (313), (324), (321),
		(318), (337), (348), (349), (325), (336), (346), (344), (342), (352), (351), (354)

	SELECT 
		lb.LoanBrokerCommissionID,
		lb.BrokerID,
		lb.CommissionAmount,
		lb.PaidDate,
		ci.SortCode,
		ci.BankAccount,
		c.Fullname CustomerName
	FROM 
		LoanBrokerCommission lb 
		INNER JOIN Broker b ON b.BrokerID = lb.BrokerID
		INNER JOIN CardInfo ci ON ci.Id = lb.CardInfoID
		INNER JOIN Loan l ON l.Id = lb.LoanID
		INNER JOIN Customer c ON c.Id = l.CustomerId
		INNER JOIN @t t ON lb.LoanBrokerCommissionID = t.LoanBrokerCommissionID
END
GO
